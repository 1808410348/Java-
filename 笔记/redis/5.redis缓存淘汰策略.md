### redis 缓存淘汰策略

#### 往 redis 里写的数据是怎么没了的？

redis 过期键的删除策略，如果一个键是过期，那它到期之后是不是马上就从内存中删除呢？如果回答是，基本本次面试基本宣告失败。如果不是，那过期后到底什么时候被删除呢？

三种不同的删除策略

1. 定时删除
   Redis不可能时时刻刻遍历所有被设置上了生存时间的key，来检测数据是否已经到达过期时间，然后对它进行删除。
   立马删除能保证内存中数据的最大新鲜度，因为它保证过期键值会在过期后马上被删除，其所占用的内存也会随之被释放，但是立即删除对CPU是最不友好的，因为删除操作会占用CPU的时间，如果刚好碰上了CPU很忙的时候，比如正在做交集或排序等计算的时候，就会给CPU造成额外的压力，让CPU心累，时时需要删除。
   **这会产生大量的性能消耗，同时也会影响数据的读取操作。**
   总结：对CPU不友好，用处理器性能换取存储空间（时间换空间）
2. 惰性删除
   数据到达过期时间不删除，不做处理，等下次访问该数据的时候，**如果未过期**，返回数据；**如果过期**，删除，返回不存在
   **惰性删除策略的缺点是，它对内存是最不有好的。**
   如果一个键已经过期，而这个键又仍然保留在数据库中，那么只要这个过期键不被删除，它所占用的内存就不会释放。
   在使用惰性删除策略时，如果数据库中有非常多的过期键，而这些过期键又恰好没有被访问的话，那么他们也许永远都不会被删除（除非用户手动执行FLUSHDB），我们甚至可以将这种情况看作是一种内存泄露，无用的垃圾数据占用了大量的内存，而服务器却不会自己去释放他们，这对于运行状态非常依赖于内存的Redis服务器来说，这不是一个好消息。
3. 定期删除