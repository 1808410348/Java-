实例化/初始化

实例化：内存中申请一块内存空间，好似租赁一房子，自己的家具东西都还没有搬家进去。

初始化属性填充：完成属性的各种赋值，好似装修、家电家具进场。

#### 3个Map和四大方法，总体相关对象

![三个Map和四大方法](images/三个Map和四大方法.jpg)

第一层 singletonObjects 存放的是已经初始化好了的Bean，

第二层 earlySingletonObjects 存放的是实例化了，但未初始化的Bean，

第三层singletonFactories存放的是FactoryBean。假如A类实现了FactoryBean，那么依赖注入的时候不是A类，而是A类产生的Bean。

![三个Map](images/三个Map.jpg)

#### A/B两对象在三级缓存中的迁移说明

1. A创建过程中需要B，于是A将自己放到三级缓存里面，去实例化B
2. B实例化的时候发现需要A，于是B先去一级缓存查找，没有，再去二级缓存查，还是没有，在查三级缓存，找到了A然后把三级缓存里面的这个A放到二级缓存里面，并删除三级缓存里面的A
3. B顺利初始化完成，将自己放到一级缓存里面（此时B里面的A是创建中状态），然后回来接着创建A，此时B已经创建结束，直接从一级缓存里面拿B，然后完成创建，并将A自己放到一级缓存里面。

![](images/ObjectFactory.jpg)













---------------------

